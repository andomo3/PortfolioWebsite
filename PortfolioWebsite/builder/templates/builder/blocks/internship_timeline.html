{% load builder_extras %}
<section class="section-block internship-timeline-block">
  <div class="page-shell">
    {% with heading=props|dict_get:"heading" %}
      {% if heading %}
        <h2 class="h3 fw-bold">{{ heading }}</h2>
      {% endif %}
    {% endwith %}
    {% with subtitle=props|dict_get:"subtitle" %}
      {% if subtitle %}
        <p class="text-muted">{{ subtitle }}</p>
      {% endif %}
    {% endwith %}

    {% with items=props|dict_get:"items" %}
    <div class="timeline">
      {% for item in items|as_list %}
        <div class="timeline-item">
          <div class="timeline-dot"></div>
          <div class="experience-card card-premium p-4">
            <div class="d-flex flex-wrap justify-content-between align-items-center mb-2">
              <div>
                <h3 class="h5 fw-bold mb-1">
                  {{ item|dict_get:"title" }}{% if item|dict_get:"company" %} - {{ item|dict_get:"company" }}{% endif %}
                </h3>
                {% if item|dict_get:"duration" %}
                  <div class="text-muted small">{{ item|dict_get:"duration" }}</div>
                {% endif %}
              </div>
              {% with item_url=item|dict_get:"url" %}
              {% with item_slug=item|dict_get:"slug" %}
                {% if item_url or item_slug %}
                  <a class="btn btn-primary btn-sm" href="{% if item_url %}{{ item_url }}{% else %}/p/internships/{{ item_slug }}/{% endif %}">View</a>
                {% endif %}
              {% endwith %}
              {% endwith %}
            </div>

            {% if item|dict_get:"subtitle" %}
              <p class="text-muted">{{ item|dict_get:"subtitle"|markdown_bold|safe }}</p>
            {% endif %}

            {% with highlights=item|dict_get:"highlights" %}
              {% if highlights %}
                <ul>
                  {% for entry in highlights|as_list %}
                    <li>{{ entry }}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            {% endwith %}

            {% with tech_stack=item|dict_get:"techStack" %}
              {% if tech_stack %}
                <div class="d-flex flex-wrap gap-2 mt-3">
                  {% for tech in tech_stack|as_list %}
                    <span class="tech-badge">{{ tech }}</span>
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}
          </div>
        </div>
      {% empty %}
        <p class="text-muted">Add internships to this timeline.</p>
      {% endfor %}
    </div>
    {% endwith %}
  </div>
</section>
